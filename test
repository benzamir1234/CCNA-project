# Define input and output file paths
$inputFile = "more.txt"
$outputFile = "output2.txt"

# Read each email from the input file
Get-Content $inputFile | ForEach-Object {
    # Trim whitespace from the email
    $email = $_.Trim()

    # Invoke the command and capture the output
    $output = Invoke-AADIntUserEnumerationAsOutsider -UserName $email

    # Append the output to the output file
    Add-Content -Path $outputFile -Value $output

    # Wait for 1 second before trying the next email
    Start-Sleep -Seconds 1
}
